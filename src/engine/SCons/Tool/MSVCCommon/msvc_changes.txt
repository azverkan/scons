The Visual Studio support has been totally revamped. Instead of using registry
magic, we use the .bat files available for each version of visual studio. This
is simpler (does not depend on the version of the compiler), more reliable, and
just plain better.

Specification
=============

Tested versions
---------------

The following versions have been succesfully tested:
	- VS 2008 (express) with SDK 6.0A, 32 bits
	- VS 2005 (express), 32 bits
	- VS 2003 (.Net, pro), 32 bits

All tools related to the ms toolchain are detected through the same method:
	- detect the .bat configuration file (vsvarsall.bat/vsvars32.bat
	  depending on the version) from the registry
	- if registry does not return anything useful, use the VS*COMNTOOLS env
	  variable.

A version is detected only when the .bat file actually exists on the
filesystem.  Once the .bat file is found, it is executed through a clean
environment, and its output is parsed to get the variables
PATH/LIB/LIBPATH/INCLUDE. Those variables are then added to env['ENV']

Fundamental changes
===================

env["ENV"] has been expanded a bit on windows:
	- add %SYSTEMROOT%\system32 in the path for windows
	- add COMSPEC (needed by the .bat file execution)

UI
==

For the user, there should not be any difference.  By default, the most recent
version of Visual Studio will be used, and the version can be tweaked by using
the MSVS_VERSION. A scons script can use different version of VS at the same
time.

Internals
=========

The code can be found in the MSVCCommon submodule: 
	- findloc: find the product dir from the registry or the shell environment
	- versions: query the system for available versions on the system
	- misc: high level functions, candidate for the public API.
	- sdk: specifs to the SDK detection.
	- defaults: default values to use for the paths, to use instead of the
	  whole env parsing which can be quite slow, but less reliable. Still
	  experimental
	- envhelpers: functions to execute a VS .bat file, parse its output,
	  and get the variables with modified values.

At this point, no function should be public, the exact API is not good yet.
