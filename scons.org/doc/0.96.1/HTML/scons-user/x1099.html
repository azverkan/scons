<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML
><HEAD
><TITLE
>Modifying a Construction Environment</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REL="HOME"
TITLE="SCons User Guide 0.96.1"
HREF="book1.html"><LINK
REL="UP"
TITLE="Construction Environments"
HREF="c972.html"><LINK
REL="PREVIOUS"
TITLE="Expanding Values From a Construction Environment"
HREF="x1073.html"><LINK
REL="NEXT"
TITLE="Controlling the External Environment Used to Execute Build Commands"
HREF="c1171.html"></HEAD
><BODY
CLASS="SECTION"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>SCons User Guide 0.96.1</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x1073.html"
ACCESSKEY="P"
>&#60;&#60;&#60; Previous</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Construction Environments</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="c1171.html"
ACCESSKEY="N"
>Next &#62;&#62;&#62;</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECTION"
><H1
CLASS="SECTION"
><A
NAME="AEN1099"
></A
>Modifying a <TT
CLASS="LITERAL"
>Construction Environment</TT
></H1
><P
>&#13;   <TT
CLASS="APPLICATION"
>SCons</TT
> provides various methods that
   support modifying existing values in a construction environment.

   </P
><DIV
CLASS="SECTION"
><H2
CLASS="SECTION"
><A
NAME="AEN1104"
></A
>Replacing Values in a <TT
CLASS="LITERAL"
>Construction Environment</TT
></H2
><P
>&#13;     You can replace existing construction variable values
     using the <TT
CLASS="FUNCTION"
>Replace</TT
> method:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>        env = Environment(CCFLAGS = '-DDEFINE1')
        env.Replace(CCFLAGS = '-DDEFINE2')
        env.Program('foo.c')
     </PRE
></TD
></TR
></TABLE
><P
>&#13;     The replacing value
     (<TT
CLASS="LITERAL"
>-DDEFINE2</TT
> in the above example)
     completely replaces the value in the
     construction environment:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>        % <TT
CLASS="USERINPUT"
><B
>scons -Q</B
></TT
>
        cc -DDEFINE2 -c -o foo.o foo.c
        cc -o foo foo.o
     </PRE
></TD
></TR
></TABLE
><P
>&#13;     You can safely call <TT
CLASS="FUNCTION"
>Replace</TT
>
     for construction variables that
     don't exist in the construction environment:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>        env = Environment()
        env.Replace(NEW_VARIABLE = 'xyzzy')
        print "NEW_VARIABLE =", env['NEW_VARIABLE']
     </PRE
></TD
></TR
></TABLE
><P
>&#13;     In this case,
     the construction variable simply
     gets added to the construction environment:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>        % <TT
CLASS="USERINPUT"
><B
>scons -Q</B
></TT
>
        NEW_VARIABLE = xyzzy
        scons: `.' is up to date.
     </PRE
></TD
></TR
></TABLE
><P
>&#13;     Because the variables
     aren't expanded until the construction environment
     is actually used to build the targets,
     and because <TT
CLASS="APPLICATION"
>SCons</TT
> function and method calls
     are order-independent,
     the last replacement "wins"
     and is used to build all targets,
     regardless of the order in which
     the calls to Replace() are
     interspersed with calls to
     builder methods:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>        env = Environment(CCFLAGS = '-DDEFINE1')
        print "CCFLAGS =", env['CCFLAGS']
        env.Program('foo.c')

        env.Replace(CCFLAGS = '-DDEFINE2')
        print "CCFLAGS =", env['CCFLAGS']
        env.Program('bar.c')
     </PRE
></TD
></TR
></TABLE
><P
>&#13;     The timing of when the replacement
     actually occurs relative
     to when the targets get built
     becomes apparent
     if we run <TT
CLASS="APPLICATION"
>scons</TT
> without the <TT
CLASS="LITERAL"
>-Q</TT
>
     option:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>        % <TT
CLASS="USERINPUT"
><B
>scons</B
></TT
>
        scons: Reading SConscript files ...
        CCFLAGS = -DDEFINE1
        CCFLAGS = -DDEFINE2
        scons: done reading SConscript files.
        scons: Building targets ...
        cc -DDEFINE2 -c -o bar.o bar.c
        cc -o bar bar.o
        cc -DDEFINE2 -c -o foo.o foo.c
        cc -o foo foo.o
        scons: done building targets.
     </PRE
></TD
></TR
></TABLE
><P
>&#13;     Because the replacement occurs while
     the <TT
CLASS="FILENAME"
>SConscript</TT
> files are being read,
     the <TT
CLASS="LITERAL"
>$CCFLAGS</TT
>
     variable has already been set to
     <TT
CLASS="LITERAL"
>-DDEFINE2</TT
>
     by the time the <TT
CLASS="FILENAME"
>foo.o</TT
> target is built,
     even though the call to the <TT
CLASS="FUNCTION"
>Replace</TT
>
     method does not occur until later in
     the <TT
CLASS="FILENAME"
>SConscript</TT
> file.

     </P
></DIV
><DIV
CLASS="SECTION"
><H2
CLASS="SECTION"
><A
NAME="AEN1135"
></A
>Appending to the End of Values in a <TT
CLASS="LITERAL"
>Construction Environment</TT
></H2
><P
>&#13;     You can append a value to
     an existing construction variable
     using the <TT
CLASS="FUNCTION"
>Append</TT
> method:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>        env = Environment(CCFLAGS = '-DMY_VALUE')
        env.Append(CCFLAGS = ' -DLAST')
        env.Program('foo.c')
     </PRE
></TD
></TR
></TABLE
><P
>&#13;     <TT
CLASS="APPLICATION"
>SCons</TT
> then supplies both the <TT
CLASS="LITERAL"
>-DMY_VALUE</TT
> and
     <TT
CLASS="LITERAL"
>-DLAST</TT
> flags when compiling the object file:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>        % <TT
CLASS="USERINPUT"
><B
>scons -Q</B
></TT
>
        cc -DMY_VALUE -DLAST -c -o foo.o foo.c
        cc -o foo foo.o
     </PRE
></TD
></TR
></TABLE
><P
>&#13;     If the construction variable doesn't already exist,
     the <TT
CLASS="FUNCTION"
>Append</TT
> method will create it:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>        env = Environment()
        env.Append(NEW_VARIABLE = 'added')
        print "NEW_VARIABLE =", env['NEW_VARIABLE']
     </PRE
></TD
></TR
></TABLE
><P
>&#13;     Which yields:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>        % <TT
CLASS="USERINPUT"
><B
>scons -Q</B
></TT
>
        NEW_VARIABLE = added
        scons: `.' is up to date.
     </PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="SECTION"
><H2
CLASS="SECTION"
><A
NAME="AEN1153"
></A
>Appending to the Beginning of Values in a <TT
CLASS="LITERAL"
>Construction Environment</TT
></H2
><P
>&#13;     You can append a value to the beginning
     an existing construction variable
     using the <TT
CLASS="FUNCTION"
>Prepend</TT
> method:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>        env = Environment(CCFLAGS = '-DMY_VALUE')
        env.Prepend(CCFLAGS = '-DFIRST ')
        env.Program('foo.c')
     </PRE
></TD
></TR
></TABLE
><P
>&#13;     <TT
CLASS="APPLICATION"
>SCons</TT
> then supplies both the <TT
CLASS="LITERAL"
>-DFIRST</TT
> and
     <TT
CLASS="LITERAL"
>-DMY_VALUE</TT
> flags when compiling the object file:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>        % <TT
CLASS="USERINPUT"
><B
>scons -Q</B
></TT
>
        cc -DFIRST -DMY_VALUE -c -o foo.o foo.c
        cc -o foo foo.o
     </PRE
></TD
></TR
></TABLE
><P
>&#13;     If the construction variable doesn't already exist,
     the <TT
CLASS="FUNCTION"
>Prepend</TT
> method will create it:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>        env = Environment()
        env.Prepend(NEW_VARIABLE = 'added')
        print "NEW_VARIABLE =", env['NEW_VARIABLE']
     </PRE
></TD
></TR
></TABLE
><P
>&#13;     Which yields:

     </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>        % <TT
CLASS="USERINPUT"
><B
>scons -Q</B
></TT
>
        NEW_VARIABLE = added
        scons: `.' is up to date.
     </PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x1073.html"
ACCESSKEY="P"
>&#60;&#60;&#60; Previous</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="book1.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="c1171.html"
ACCESSKEY="N"
>Next &#62;&#62;&#62;</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Expanding Values From a <TT
CLASS="LITERAL"
>Construction Environment</TT
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="c972.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Controlling the External Environment Used to Execute Build Commands</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>